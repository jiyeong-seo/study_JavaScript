<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>업비트 OPEN API</h1>
    <h2>업비트에서 제공중인 시장 정보</h2>
    <ul id="upbitMarket"></ul>
    <hr />
    <h2>거래 대상 암호화폐 한글명</h2>
    <ul id="upbitKoreanName"></ul>
    <hr />
    <h2>거래 대상 암호화폐 영문명</h2>
    <ul id="upbitEnglishName"></ul>


    <script>
      const coinList = document.querySelector("#coin_info");

      function loadMarket() {
        getData("market/all?isDetails=false", loadTicker);
      }

      loadMarket();

      function loadTicker(data) {
        const markets = data.map((e) => e.market).join(",");
        const names = data.map((e) => {
          const nameData = {};
          nameData.korean_name = e.korean_name;
          nameData.english_name = e.english_name;
          return nameData;
        });
        console.log(names);
        getData(`ticker?markets=${markets}`, printCoin);
      }

      function getData(url, callback) {
        const xhr = new XMLHttpRequest();
        const addr = `https://api.upbit.com/v1/${url}`;

        xhr.onreadystatechange = (e) => {
          const { target } = e;

          if (target.readyState === XMLHttpRequest.DONE) {
            if (target.status === 200) {
              const req = JSON.parse(target.response);

              callback(req);
            }
          }
        };
        xhr.open("GET", addr);
        xhr.send();
      }

      function printCoin(data) {
        console.log(data);
        // const coinLi = document.createElement("li");

        // coinLi.innerHTML;
      }
    </script>
  </body>
</html>
